<header>

  <div class="inner">
    <div class="logo">
      <img src='/assets/graphics/brand/serendip-farsi.svg' />
    </div>

    <div class="title" *ngIf="dashboardService.currentSection">
      <div class="icon">
        <img [src]=' "/assets/icons/" + dashboardService.currentSection.icon + ".svg"' />
      </div>
      {{dashboardService.currentSection.title}}
    </div>





    <div class="explorer-toggle" (click)="explorerVisible ? explorerMouseOut() : explorerMouseIn()" [class.active]="explorerVisible">
      <img [src]='"/assets/icons/arrow-right-next-2.svg"' />
    </div>



    <div class="container-add" (click)="addContainer()">
      <img [src]='"/assets/icons/plus-add-2.svg"' />
    </div>


    <div class="clear"></div>


  </div>
  <!-- 
  <nav>
    <a *ngFor="let item of dashboardService.getActiveTabs();trackBy:item?.title" [routerLink]="['/dashboard',dashboardService.currentSection.name,item.name]"
      routerLinkActive="active-link">
      <img [src]="item.icon ? '/assets/icons/' + item.icon + '.svg' : '/assets/icons/tabs/' + item.name + '.svg'" />

      <span>
        {{item.title}}
      </span>
    </a>
  </nav> -->


</header>


<aside id="explorer" [class.show]="!explorerVisible" class="closed" (mouseenter)="explorerMouseIn()" (mouseleave)="explorerMouseOut()">

  <div class="explorer-inner">

    <div class="splitter">
      ابزار های فعال
    </div>
    <ul class="active empty">


    </ul>

    <div class="splitter">
      مدیریت مشتری
    </div>
    <ul class="crm">
      <li *ngFor="let section of  getExplorerSections(dashboardService.schema)">
        <a (click)="section.toggleUl = !section.toggleUl">
          <img [src]="'assets/icons/' + section.icon + '.svg'" />
          <span>
            {{section.title}}
          </span>

          <img class="toggle-ul" [class.active]="section.toggleUl" [src]='"/assets/icons/arrow-right-next-8.svg"' />

        </a>

        <ul [class.show]="section.toggleUl">
          <li *ngFor="let tab of getExplorerTabs( section.tabs)">
            <a [dndEffectAllowed]="'all'" [dndDraggable]="{ tab : tab}">
              <div class="img">
                <img [src]="'assets/icons/' + tab.icon + '.svg'" />
              </div>
              <span>
                {{tab.title}}
              </span>
            </a>
          </li>
        </ul>
      </li>

    </ul>

  </div>

</aside>



<div class="grid-container f{{gridLayout.containers.length}}" [class.explorer-show]="explorerVisible" [class.go-back]="!explorerAnimDone">

  <div class="tabs-container" dndDropzone (dndDragover)="onTabDragover($event,c)" (dndDrop)="onTabDrop($event,c)"
    *ngFor="let container of gridLayout.containers;let c = index">

    <!--optional placeholder element for dropzone-->
    <!--will be removed from DOM on init-->
    <div class="placeholder" dndPlaceholderRef>

    </div>

    <ul class="tabs-nav">
      <li *ngFor="let tab of container.tabs;let i = index" [class.nextIsActive]="container.tabs[i + 1] && container.tabs[i + 1].active"
        [class.prevIsActive]="container.tabs[i - 1] && container.tabs[i - 1].active" [class.active]="tab.active"
        (click)="setTabActive(tab,container)">

        <a class="tab-handle" [dndEffectAllowed]="'all'" [dndDraggable]="{ containerIndex : c,tabIndex : i}">
          <div class="tab-icon">
            <img [src]="'assets/icons/' + tab.icon + '.svg'" />
          </div>
          <div class="tab-title">
            {{tab.title}}
          </div>
          <div class="tab-close" (click)="closeTab(c,i)">
            <img [src]="'assets/icons/close-5.svg'" />
          </div>
        </a>

      </li>

      <li [class.prevIsActive]="container.tabs[container.tabs.length - 1] && container.tabs[container.tabs.length - 1].active">
        <a class="tab-handle">
          &nbsp;
        </a>
      </li>



    </ul>

    <div *ngFor="let tab of container.tabs" [hidden]="!tab.active">
      <div class="widget-container" *ngFor="let widget of getTabWidgets(tab)" [hidden]="widget.screen && widget.screen != dashboardService.screen">
        <ndc-dynamic *ngIf="!widget.screen || widget.screen == dashboardService.screen" [ndcDynamicComponent]="getComponent( widget.component)"></ndc-dynamic>
      </div>
    </div>

  </div>
</div>


<div *ngIf='crmService.getActiveCrmId()' id="start-button" (click)="startActive = !startActive">
  <img src="assets/graphics/brand/serendip-circle.svg" alt="" />
</div>

<div id="start" (click)="clickOnStartWrapper($event)" [class.fadeIn]="startActive">

  <div class="inner">
    <div class="search">
      <div class="search-inner">
        <input type="text" dir="auto" [(ngModel)]="search.text" placeholder="جست‌و‌جو ..." />
        <img src='assets/icons/search.svg' />
      </div>
    </div>
    <nav>
      <ul>
        <li *ngFor="let item of dashboardService.schema">
          <a [routerLink]="item.name == 'dashboard' ? ['/dashboard'] : ['/dashboard',item.name]">
            <img [src]="'assets/icons/' + item.icon + '.svg'" />
            <span>
              {{item.title}}
            </span>
          </a>
        </li>

      </ul>
    </nav>

    <div class="tabs">

      <div class="tabs-inner">

        <mat-tab-group [color]="'ascent'" dynamicHeight="true">
          <mat-tab label="پیام‌ها">
            <div class="tab-content">

            </div>
          </mat-tab>
          <mat-tab label="اعلان‌ها">
            <div class="tab-content">
            </div>
          </mat-tab>
          <mat-tab label="وظایف">
            <div class="tab-content">
            </div>
          </mat-tab>
        </mat-tab-group>
      </div>

    </div>
  </div>
</div>